/**
 * ng-scrollbar
 * @version v0.0.8 - 2017-08-29
 * @link https://github.com/asafdav/ng-scrollbar
 * @author Asaf David <asafdav@gmail.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"use strict";angular.module("ngScrollbar",[]).directive("ngScrollbar",["$parse","$window","$timeout",function(a,b,c){return{restrict:"A",replace:!0,transclude:!0,scope:{showYScrollbar:"=?isBarShown",touchEventWidth:"=",hideScrollOnOut:"="},link:function(a,d,e){var g,h,i,j,k,l,m,n,o,p,q,r=function(){var b=a.touchEventWidth||768;return window.innerWidth<=b},s=function(){return a.hideScrollOnOut&&r()},t=function(a){return r()?-a:a},u={bottom:e.hasOwnProperty("bottom")},v=angular.element(b),w=!!v[0].addEventListener,x=!!v[0].removeEventListener,y={top:0},z={top:0},A=function(){m={position:"relative",overflow:"hidden","max-width":"100%",height:"100%"},z.height&&(m.height=z.height+"px"),n={position:"absolute",height:y.height+"px",top:y.top+"px"},o={position:"relative","line-height":y.height+"px"},p={position:"relative",top:z.top+"px",overflow:"hidden"}},B=function(){j.css("top",y.top+"px");var a=y.top/z.height;z.top=-Math.round(z.scrollHeight*a),h.css("top",z.top+"px")},C=function(a){var b=a.hasOwnProperty("offsetY")?a.offsetY:a.layerY,c=Math.max(0,Math.min(parseInt(y.trackHeight,10)-parseInt(y.height,10),b));y.top=c,B(),a.stopPropagation()},D=function(a){var b=40,c=a,d=c.detail,e=c.wheelDelta,g=225,h=g-1;return d=d?e&&(f=e/d)?d/f:-d/1.35:e/120,d=1>d?-1>d?(-Math.pow(d,2)-h)/g:d:(Math.pow(d,2)+h)/g,a.delta=Math.min(Math.max(d/2,-1),1),a.delta=a.delta*b,y.top=Math.max(0,Math.min(parseInt(z.height,10)-parseInt(y.height,10),parseInt(y.top,10)-a.delta)),B(),a.preventDefault?void a.preventDefault():!1},E=0,F=function(a,b,c){y.top=Math.max(0,Math.min(parseInt(y.trackHeight,10)-parseInt(y.height,10),t(c))),a.stopPropagation()},G=function(a){var b=0,c=a.pageY-j[0].scrollTop-E;F(a,b,c),B()},H=function(a){v.off("mousemove",G),v.off("mouseup",H),a.stopPropagation()},I=function(a){var b=0,c=a.changedTouches?a.changedTouches:a.originalEvent.changedTouches,d=c[0].pageY-parseInt(j.css("top")||0)-E;F(a,b,d),B()},J=function(a){v.off("touchmove",I),v.off("touchend",J),a.stopPropagation()},K=function(a,b){var c=b||"mousewheel";w?a.addEventListener(c,D,!1):a.attachEvent("on"+c,D)},L=function(a,b){var c=b||"mousewheel";x?a.removeEventListener(c,D,!1):a.detachEvent("on"+c,D)},M=function(b){b=u.bottom||b,g=angular.element(d.children()[0]),h=angular.element(g.children()[0]),i=angular.element(g.children()[1]),j=angular.element(angular.element(i.children()[0]).children()[0]),k=angular.element(j.children()[0]),l=angular.element(angular.element(i.children()[0]).children()[1]),z.height=d[0].offsetHeight,z.scrollHeight=h[0].scrollHeight;var e=function(){c(function(){a.showYScrollbar=!0,a.$emit("scrollbar.show")})},f=function(b){c(function(){a.showYScrollbar=!1,a.$emit("scrollbar.hide")})};if(z.height<z.scrollHeight){s()||e(),y.height=Math.round(z.height/z.scrollHeight*z.height),y.trackHeight=z.height,A(),d.css({overflow:"hidden"}),g.css(m),h.css(p),j.css(n),k.css(o),l.bind("click",C),K(h[0]),j.on("mousedown",function(a){E=a.pageY-j[0].offsetTop,v.on("mouseup",H),v.on("mousemove",G),a.preventDefault()}),a.showHideScroller=function(b,c){var d=a.hideScrollOnOut?c?e:f:function(){};d(b)};var q=function(b){var c=b.changedTouches?b.changedTouches:b.originalEvent.changedTouches;E=c[0].pageY-j[0].offsetTop,v.on("touchend",J),v.on("touchmove",I),s()&&a.showHideScroller(b,!0),b.preventDefault()},r=function(b){s()&&a.showHideScroller(b,!1)};j.on("touchstart",q),h.on("touchstart",function(a){q(a)}),h.on("touchend",r),b?(u.bottom=!1,y.top=parseInt(z.height,10)-parseInt(y.height,10)):y.top=Math.max(0,Math.min(parseInt(z.height,10)-parseInt(y.height,10),parseInt(y.top,10))),B()}else f(),j.off("mousedown"),L(h[0]),h.attr("style","position:relative;top:0"),g.css({height:"100%"})},N=function(b,c){null!=q&&clearTimeout(q);var d=!!c&&!!c.rollToBottom;q=setTimeout(function(){z.height=null,M(d),a.$$phase||a.$digest(),a.$parent.$$phase||a.$parent.$digest()},72)};M(),e.rebuildOn&&e.rebuildOn.split(" ").forEach(function(b){a.$on(b,N)}),e.hasOwnProperty("rebuildOnResize")&&v.on("resize",N)},template:'<div><div class="ngsb-wrap" ng-mouseenter="showHideScroller($event, true)" ng-mouseleave="showHideScroller($event, false)"><div class="ngsb-container" ng-transclude></div><div class="ngsb-scrollbar" style="position: absolute; display: block;" ng-show="showYScrollbar"><div class="ngsb-thumb-container"><div class="ngsb-thumb-pos" oncontextmenu="return false;"><div class="ngsb-thumb" ></div></div><div class="ngsb-track"></div></div></div></div></div>'}}]);